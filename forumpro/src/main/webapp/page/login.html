<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>讨论板的登录界面</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <div class="container mt-5">
        <h2 class="text-center">用户登录</h2>
        <form action="#" method="POST" id="loginForm" class="mx-auto" style="max-width: 300px;">
            <div class="form-group">
                <label for="username">用户名:</label>
                <input type="text" id="username" name="username" required class="form-control">
            </div>
            <div class="form-group">
                <label for="password">密码:</label>
                <input type="password" id="password" name "password" required class="form-control">
            </div>
            <div class="form-group">
                <input type="submit" value="登录" class="btn btn-primary btn-block">
            </div>
        </form>
    </div>

    <!-- 引入 Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        $("#loginForm").submit(function(e) {
            e.preventDefault(); // 阻止默认的表单提交行为

            // 获取表单数据
            var formData = {
                userId: $("#username").val(),
                passwd: $("#password").val(),
            };
            console.log(formData)

            // 向服务器端发送登录请求
            $.ajax({
                type: "POST",
                url: "/login", // 后台处理添加书籍的URL
                data: formData,
                success: function (response) {
                    // 在这里可以处理成功后的操作
                    alert("登录成功");

                    // 从表单获取用户名
                    var userId = formData.userId;

                    // 将userId存储在本地存储中
                    localStorage.setItem('userId', userId);

                    // 可以将页面重定向到其他位置
                    window.location.replace("allMessage.html");
                },
                error: function () {
                    // 在这里可以处理错误情况
                    alert("登录失败");
                }
            });
        });
    });
</script>

</body>
</html>